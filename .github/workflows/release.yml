name: 'RELEASE'

on:
  release:
    types: [published]

jobs:
  upload-to-steam:
    name: Upload to Steam Workshop
    if: ${{ !github.event.release.prerelease }} # Do not upload pre releases
    runs-on: windows-latest
    steps:
        - name: Checkout repo
          uses: actions/checkout@v2
        - name: Build with HEMTT
          uses: gruppe-adler/action-release-with-hemtt@2.2.0
          id: build
        - name: SFTP uploader
          uses: SamKirkland/FTP-Deploy-Action@4.3.3
          with:
            server: ${{ secrets.SFTP_HOST }}
            port: ${{ secrets.SFTP_PORT }}
            username: ${{ secrets.SFTP_USERNAME }}
            password: ${{ secrets.SFTP_PASSWORD }}
            local-dir: "${{ steps.build.outputs.release_path }}/@${{ steps.build.outputs.mod_name }}"
            remoteDir: '/'